<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Alo Worklogs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        :root{
            --bg:#f7f8fb;
            --card:#ffffff;
            --text:#0f1115;
            --muted:#6b7280;
            --border:#e9e9ef;
            --accent:#007aff;
            --accent-press:#0063cc;
            --soft:#f2f4f8;
            --row-alt:#fafbff;
            --red:#ff3b30;
            --green:#34c759;
            --yellow:#ffcc00;
        }
        *{box-sizing:border-box; margin: 0; padding: 0}
        html,body{height:100%}
        body{
            margin:0; padding:0;
            font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Inter,system-ui,Arial,sans-serif;
            color:var(--text); background:var(--bg);
            display:flex; min-height:100vh;
        }

        /* Shell */
        .app-shell{ display:flex; width:100%; flex:1; }
        .sidebar{
            width:250px; background:var(--card); border-right:1px solid var(--border);
            padding:24px 20px; box-shadow:0 6px 24px rgba(0,0,0,.05);
            display:flex; flex-direction:column; gap:24px; min-height:100vh;
        }
        .sidebar .brand{ font-size:20px; font-weight:700; display:flex; flex-direction:column; gap:6px; }
        .sidebar .brand small{ font-size:12px; font-weight:600; color:var(--muted); letter-spacing:.2px; }
        .menu{ display:flex; flex-direction:column; gap:6px; flex:1; }
        .menu-item{
            text-align:left; border:0; background:transparent; padding:10px 14px; border-radius:12px;
            font-weight:600; color:var(--muted); cursor:pointer; transition:background .15s ease, color .15s ease;
            width:100%;
        }
        .menu-item:hover{ background:var(--soft); color:var(--text); }
        .menu-item.is-active{ background:var(--accent); color:#fff; }
        .sidebar-footer{ margin-top:auto; }
        .sidebar-footer .btn{ width:100%; justify-content:center; display:inline-flex; align-items:center; }

        .main-area{ flex:1; padding:32px; overflow-y:auto; background:var(--bg); }
        .page{ display:none; max-width:1240px; margin:0 auto; }
        .page.is-active{ display:block; }
        .app{ max-width:1240px; margin:0 auto; }
        header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; }
        h1{ font-size:20px; margin:0; letter-spacing:.2px; }
        .muted{ color:var(--muted); font-size:13px }

        /* Cards / Controls */
        .card{
            background:var(--card); border:1px solid var(--border);
            border-radius:16px; padding:14px; box-shadow:0 6px 24px rgba(0,0,0,.04);
        }
        .controls{
            display:grid; gap:10px;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            align-items:end;
        }
        .field{ display:flex; flex-direction:column; gap:6px; }
        .label{ font-size:12px; font-weight:600; color:#2a2a2a; padding-left:2px; }

        /* Base URL input with icon + status */
        .input-wrap{ position:relative; display:flex; align-items:center; }
        .input-wrap input{
            width:100%; padding:10px 32px 10px 36px; border-radius:12px;
            border:1px solid var(--border); background:#fff; color:var(--text);
            outline:none; transition:border-color .15s ease, box-shadow .15s ease;
        }
        .input-wrap input:focus{ border-color:var(--accent) }
        .left-icon{
            position:absolute; left:10px; width:16px; height:16px; color:var(--muted); opacity:.9;
        }
        .status-dot{
            position:absolute; right:10px; width:10px; height:10px; border-radius:50%; background:#c9ccd4;
        }
        .input-wrap.is-valid input{ border-color:#cfe9d6; }
        .input-wrap.is-valid .status-dot{ background:var(--green); }
        .input-wrap.is-invalid input{ border-color:#ffd0d0; }
        .input-wrap.is-invalid .status-dot{ background:var(--red); }
        .help{ font-size:12px; color:var(--muted); margin-top:4px; padding-left:2px; }

        /* Selects & other inputs */
        input[type="text"], input[type="number"], select{
            appearance:none; -webkit-appearance:none;
            width:100%; padding:10px 12px; border-radius:12px;
            border:1px solid var(--border); background:#fff; color:var(--text);
            outline:none; transition:border-color .15s ease;
        }
        input[type="text"]:focus, input[type="number"]:focus, select:focus{ border-color:var(--accent) }
        .actions{ display:flex; gap:8px; justify-content:flex-end; align-items:center; }

        /* Buttons */
        .btn{
            border:1px solid var(--border); background:#fff; color:var(--text);
            border-radius:12px; padding:10px 14px; font-weight:600; cursor:pointer;
            transition: background .15s ease, border-color .15s ease, transform .02s ease;
        }
        .btn:hover{ background:var(--soft) }
        .btn:active{ transform:translateY(1px) }
        .btn-primary{ background:var(--accent); border-color:var(--accent); color:#fff; }
        .btn-primary:hover{ background:var(--accent-press); border-color:var(--accent-press) }
        .btn-ghost{ background:transparent; border-color:transparent; color:var(--muted); }
        .btn-ghost:hover{ background:var(--soft); color:var(--text) }

        /* Legend */
        .legend{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin:12px 4px 0 }
        .chip{ display:inline-block; width:14px; height:14px; border-radius:4px; border:1px solid var(--border); margin-right:6px; vertical-align:middle; }

        /* Tables */
        .table-wrap{
            margin-top:12px; border:1px solid var(--border); border-radius:16px; overflow:hidden; background:var(--card);
            box-shadow:0 6px 24px rgba(0,0,0,.04);
        }
        table{ width:100%; border-collapse:separate; border-spacing:0 }
        thead th{
            position:sticky; top:0; background:#fafafa; z-index:1;
            font-size:12px; text-transform:uppercase; letter-spacing:.02em; color:#444;
            border-bottom:1px solid var(--border); padding:10px 12px; text-align:left;
        }
        tbody td{ padding:10px 12px; border-bottom:1px solid var(--border) }
        /* IMPORTANT: no odd-even for the FIRST table; keep colors 100% visible */
        /* Stripe only the detailed table: */
        #detailedWorklogsTable tbody tr:nth-child(2n){ background:var(--row-alt) }

        tfoot td{ position:sticky; bottom:0; background:#fff; border-top:1px solid var(--border); padding:10px 12px; }

        /* Row status colors (calendar) */
        tr.gray   { background:#f5f6f8; color:#aaa; }
        tr.green  { background:#eaf9ef; }
        tr.yellow { background:#fff8e1; }
        tr.red    { background:#ffeef0; }

        /* Footer pills */
        .footer-grid{ display:flex; flex-wrap:wrap; gap:10px 16px; align-items:center; line-height:1.5 }
        .pill{ display:inline-flex; gap:6px; align-items:center; padding:6px 10px; border-radius:999px;
            background:var(--soft); border:1px solid var(--border); font-size:13px; }
        .pill strong{ font-weight:700 }
        .delta-pos{ color:var(--green) }
        .delta-neg{ color:var(--red) }

        /* Sections */
        .section-title{ font-size:16px; margin:18px 4px 8px; font-weight:700 }

        .table-wrap.small{ max-height:42vh; overflow:auto; }

        /* Tooltip (for Jalaali cell showing Gregorian) */
        .tip{ position:relative; cursor:help; border-bottom:1px dotted rgba(0,0,0,.2); }
        .tip[data-tip]::after{
            content:attr(data-tip);
            position:absolute; left:0; top:100%;
            transform:translateY(8px);
            background:#111; color:#fff; font-size:12px; padding:6px 8px; border-radius:8px; white-space:nowrap;
            opacity:0; pointer-events:none; transition:opacity .12s ease, transform .12s ease;
        }
        .tip[data-tip]:hover::after{ opacity:1; transform:translateY(6px); }
        /* keep inside viewport */
        .tip[data-tip]{ max-width:100%; overflow:visible }

        /* Debug */
        pre{ white-space:pre-wrap; background:#fff; border:1px solid var(--border); border-radius:12px; padding:10px; color:#374151 }
    </style>
</head>
<body>
<div class="app-shell">
    <aside class="sidebar">
        <div class="brand">
            <span>Alo Worklogs</span>
            <small>by SkyBlueDev</small>
        </div>
        <nav class="menu">
            <button class="menu-item is-active" data-route="profile" type="button">Profile</button>
            <button class="menu-item" data-route="monthly-report" type="button">Monthly Report</button>
        </nav>
        <div class="sidebar-footer">
            <button class="btn btn-ghost" id="logout" type="button">Logout</button>
        </div>
    </aside>

    <main class="main-area">
        <section class="page is-active" data-page="profile">
            <div class="card" style="margin-top:10px;">
                <h2 style="margin-bottom:8px;">Profile</h2>
                <p class="muted">Your profile information will be available here soon.</p>
            </div>
        </section>

        <section class="page" data-page="monthly-report">
            <div class="app">
                <header>
                    <h1>Monthly Report</h1>
                </header>
                <div class="muted">Timezone: <strong>Asia/Tehran</strong>. Thu/Fri & static holidays are non-workdays. Future days are shown too.</div>

                <div class="card" style="margin-top:10px;">
                    <div class="controls">
                        <div class="field">
                            <span class="label">Jira Base URL</span>
                            <div class="input-wrap" id="baseUrlWrap">
                                <!-- Globe icon -->
                                <svg class="left-icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                                    <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M3 12h18M12 3c2.5 2.8 3.75 6.2 3.75 9s-1.25 6.2-3.75 9c-2.5-2.8-3.75-6.2-3.75-9S9.5 5.8 12 3Z" stroke="currentColor" stroke-width="1.5"/>
                                </svg>
                                <input id="baseUrl" placeholder="https://your-domain.atlassian.net" />
                                <span class="status-dot" id="baseUrlStatus" aria-hidden="true"></span>
                            </div>
                        </div>

                        <div class="field">
                            <span class="label">Jira User</span>
                            <select id="usernameSelect"></select>
                        </div>

                        <div class="field">
                            <span class="label">Jalaali Year</span>
                            <input id="jYear" type="text" inputmode="numeric" />
                        </div>

                        <div class="field">
                            <span class="label">Jalaali Month</span>
                            <select id="jMonth"></select>
                        </div>

                        <div class="field">
                            <span class="label">Time-off (hours this month)</span>
                            <input id="timeOffHours" type="number" step="0.5" min="0" value="0" />
                        </div>

                        <div class="actions">
                            <button class="btn" id="save">Save</button>
                            <button class="btn btn-primary" id="scan">Scan Now</button>
                        </div>
                    </div>
                </div>

                <div class="legend">
                    <span><span class="chip" style="background:#f5f6f8;"></span>Gray: non-workday (Thu/Fri/holiday) or future</span>
                    <span><span class="chip" style="background:#eaf9ef;"></span>Green: 6 to &lt;7 hours</span>
                    <span><span class="chip" style="background:#fff8e1;"></span>Yellow: 7 to 8 hours</span>
                    <span><span class="chip" style="background:#ffeef0;"></span>Red: &lt;6 hours or &gt;8 hours</span>
                </div>

                <!-- Calendar table (no odd/even stripes, status colors only) -->
                <div class="table-wrap" style="margin-top:12px;">
                    <table id="results" style="display:none;">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th>Jalaali</th>
                            <th>Weekday</th>
                            <th>Flags</th>
                            <th>Hours</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                        <tfoot>
                        <tr>
                            <td colspan="5" id="footerTotals">
                                <div class="footer-grid">
                                    <span class="pill">Totals here…</span>
                                </div>
                            </td>
                        </tr>
                        </tfoot>
                    </table>
                </div>

                <!-- Detailed Worklogs (striped) -->
                <div id="worklogsWrap" style="display:none; padding-bottom: 2rem;">
                    <div class="section-title">Detailed Worklogs</div>
                    <div class="table-wrap small">
                        <table id="detailedWorklogsTable">
                            <thead>
                            <tr>
                                <th>#</th>
                                <th>Jalaali Date</th>
                                <th>Gregorian Date</th>
                                <th>Issue</th>
                                <th>Summary</th>
                                <th>Hours</th>
                                <th>Time Spent</th>
                                <th>Comment</th>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>
</div>

<script src="./renderer.js"></script>
</body>
</html>
